<?xml version="1.0" encoding="UTF-8"?>
<mdq:check xmlns:mdq="https://nceas.ucsb.edu/mdqe"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="https://nceas.ucsb.edu/mdqe ../schemas/schema1.xsd">
	<id>check.nsf.award.numbers.present.1</id>
	<name>NSF award numbers</name>
	<description>One or more NSF award numbers must be entered.
	</description>
	<type>identification</type>
	<level>REQUIRED</level>
	<environment>rscript</environment>
	<code><![CDATA[
if (is.null(awards)) {
  status <- "FAILURE"
  output <- "No award numbers were found."
  mdq_result <- list(status = status,
                     output = list(list(value = output)))
} else if (length(title) < 1) {
  status <- "FAILURE"
  output <- paste0(length(title), " award number(s) found when at least one was expected.")
  mdq_result <- list(status = status,
                     output = list(list(value = output)))
} else if (any(nchar(awards) <= 0)) {
  status <- "FAILURE"
  output <- paste0("The following award numbers were of zero length: ", which(nchar(awards) <= 0, "."))
  mdq_result <- list(status = status,
                     output = list(list(value = output)))
} else {
  status <- "SUCCESS"
  output <- ""
  if(length(output) > 1) {
    output <- paste0("These ", length(awards), " NSF award numbers were found: ", sQuote(unlist(awards)))
  } else {
    output <- paste0("This single NSF award number was found: ", sQuote(unlist(awards)))
  }
  mdq_result <- list(status = status,
                     output = list(list(value = output)))
}]]></code>
	<selector>
		<name>awards</name>
		<xpath>/eml/dataset/project/funding/para</xpath>
	</selector>
</mdq:check>